
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../how-to-guides/">
      
      
        <link rel="next" href="../explanation/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Reference - TERN Ecosystem Processes docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#file_io" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="TERN Ecosystem Processes docs" class="md-header__button md-logo" aria-label="TERN Ecosystem Processes docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TERN Ecosystem Processes docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TERN Ecosystem Processes docs" class="md-nav__button md-logo" aria-label="TERN Ecosystem Processes docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    TERN Ecosystem Processes docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-guides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to guides
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io" class="md-nav__link">
    <span class="md-ellipsis">
      file_io
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_EddyPro_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_EddyPro_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_TOA5_backups" class="md-nav__link">
    <span class="md-ellipsis">
      get_TOA5_backups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_datearray_interval" class="md-nav__link">
    <span class="md-ellipsis">
      get_datearray_interval
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_dates" class="md-nav__link">
    <span class="md-ellipsis">
      get_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_eligible_concat_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_eligible_concat_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_headers" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_headers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_info
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_interval" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_interval
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_type_configs" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_type_configs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_formatter" class="md-nav__link">
    <span class="md-ellipsis">
      get_formatter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_header_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_header_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_start_end_dates" class="md-nav__link">
    <span class="md-ellipsis">
      get_start_end_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.reformat_data" class="md-nav__link">
    <span class="md-ellipsis">
      reformat_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.reformat_headers" class="md-nav__link">
    <span class="md-ellipsis">
      reformat_headers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.write_data_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_data_to_file
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../explanation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explanation
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io" class="md-nav__link">
    <span class="md-ellipsis">
      file_io
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_EddyPro_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_EddyPro_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_TOA5_backups" class="md-nav__link">
    <span class="md-ellipsis">
      get_TOA5_backups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_datearray_interval" class="md-nav__link">
    <span class="md-ellipsis">
      get_datearray_interval
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_dates" class="md-nav__link">
    <span class="md-ellipsis">
      get_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_eligible_concat_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_eligible_concat_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_headers" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_headers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_info
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_interval" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_interval
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_file_type_configs" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_type_configs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_formatter" class="md-nav__link">
    <span class="md-ellipsis">
      get_formatter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_header_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_header_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.get_start_end_dates" class="md-nav__link">
    <span class="md-ellipsis">
      get_start_end_dates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.reformat_data" class="md-nav__link">
    <span class="md-ellipsis">
      reformat_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.reformat_headers" class="md-nav__link">
    <span class="md-ellipsis">
      reformat_headers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculator.file_io.write_data_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_data_to_file
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p>This part of the project documentation focuses on
an <strong>information-oriented</strong> approach. Use it as a
reference for the technical implementation of the
<code>VM_data_acquisition</code> project code.</p>
<h1 id="file_io"><strong>file_io</strong></h1>


<div class="doc doc-object doc-module">



<a id="calculator.file_io"></a>
  <div class="doc doc-contents first">
  
      <p>Created on Thu Oct 12 13:37:33 2023</p>

<details class="todo" open>
  <summary>Todo</summary>
  <ul>
<li>might want some more file checks</li>
<li>can we rationalise the line / date formatters? Do we need the formatter
function at all? Roll the line and date formatters together so don't need
to call both</li>
</ul>
</details>      <p>Contains basic file input-output functions and structural configurations for
handling both TOA5 and EddyPro files. In general, and where relevant, 
intermediary data products are pandas DataFrames. The module has functions to 
retrieve both data and headers. It is strictly tasked with parsing files 
between disk and memory, checking only structural integrity of the files. 
It does NOT evaluate data integrity!</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_EddyPro_files" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_EddyPro_files</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the list of EddyPro summary files that can be concatenated.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of available backup files.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_EddyPro_files</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of EddyPro summary files that can be concatenated.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of available backup files.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">file_to_parse</span> <span class="o">=</span> <span class="n">_check_file_exists</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
    <span class="n">file_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">file_to_parse</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;*</span><span class="si">{</span><span class="n">EDDYPRO_SEARCH_STR</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">))</span>
    <span class="n">file_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
        <span class="n">file_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_to_parse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">file_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_TOA5_backups" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_TOA5_backups</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the list of TOA5 backup files that can be concatenated.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of available backup files.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_TOA5_backups</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of TOA5 backup files that can be concatenated.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of available backup files.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">file_to_parse</span> <span class="o">=</span> <span class="n">_check_file_exists</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">file_to_parse</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">file_to_parse</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">*.backup&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_data</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Read data from file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or 
<code>EddyPro</code>. If None, file_type is fetched.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>usecols</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The subset of columns to keep. If None, keep 
all.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.core.frame.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>File data content.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span>
        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">usecols</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read data from file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>
<span class="sd">        file_type: if specified, must be either `TOA5` or </span>
<span class="sd">            `EddyPro`. If None, file_type is fetched.</span>
<span class="sd">        usecols (list, optional): The subset of columns to keep. If None, keep </span>
<span class="sd">            all.</span>
<span class="sd">        Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        File data content.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If file type not supplied, detect it.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_type</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="c1"># Get dictionary containing file configurations</span>
    <span class="n">MASTER_DICT</span> <span class="o">=</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">]</span>

    <span class="c1"># Set rows to skip</span>
    <span class="n">REQ_TIME_VARS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">MASTER_DICT</span><span class="p">[</span><span class="s1">&#39;time_variables&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">CRITICAL_FILE_VARS</span> <span class="o">=</span> <span class="n">MASTER_DICT</span><span class="p">[</span><span class="s1">&#39;non_numeric_cols&#39;</span><span class="p">]</span>
    <span class="n">rows_to_skip</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">MASTER_DICT</span><span class="p">[</span><span class="s1">&#39;header_lines&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
    <span class="n">rows_to_skip</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MASTER_DICT</span><span class="p">[</span><span class="s1">&#39;header_lines&#39;</span><span class="p">][</span><span class="s1">&#39;variable&#39;</span><span class="p">])</span>

    <span class="c1"># Usecols MUST include critical non-numeric variables (including date vars)</span>
    <span class="c1"># and at least ONE additional column; if this condition is not satisifed,</span>
    <span class="c1"># do not subset the columns on import.</span>
    <span class="n">thecols</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">usecols</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">usecols</span> <span class="o">==</span> <span class="n">CRITICAL_FILE_VARS</span><span class="p">:</span>
        <span class="n">thecols</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">CRITICAL_FILE_VARS</span> <span class="o">+</span>
            <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">usecols</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">CRITICAL_FILE_VARS</span><span class="p">]</span>
            <span class="p">)</span>

    <span class="c1"># Now import data</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">file</span><span class="p">,</span>
            <span class="n">skiprows</span><span class="o">=</span><span class="n">rows_to_skip</span><span class="p">,</span>
            <span class="n">usecols</span><span class="o">=</span><span class="n">thecols</span><span class="p">,</span>
            <span class="n">parse_dates</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DATETIME&#39;</span><span class="p">:</span> <span class="n">REQ_TIME_VARS</span><span class="p">},</span>
            <span class="n">keep_date_col</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">na_values</span><span class="o">=</span><span class="n">MASTER_DICT</span><span class="p">[</span><span class="s1">&#39;na_values&#39;</span><span class="p">],</span>
            <span class="n">sep</span><span class="o">=</span><span class="n">MASTER_DICT</span><span class="p">[</span><span class="s1">&#39;separator&#39;</span><span class="p">],</span>
            <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
            <span class="n">on_bad_lines</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">,</span>
            <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s1">&#39;DATETIME&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="nb">object</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">REQ_TIME_VARS</span><span class="p">})</span>
        <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_integrity_checks</span><span class="p">,</span> <span class="n">non_numeric</span><span class="o">=</span><span class="n">CRITICAL_FILE_VARS</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_datearray_interval" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_datearray_interval</span><span class="p">(</span><span class="n">datearray</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Attempts to infer the likely time interval from non-monotonic time stamps.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>datearray</code></td>
          <td>
                <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the date array from which to infer the interval.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the inferred interval.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>RuntimeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>raised if the minimum and most common values are not the</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_datearray_interval</span><span class="p">(</span><span class="n">datearray</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Attempts to infer the likely time interval from non-monotonic time stamps.</span>

<span class="sd">    Args:</span>
<span class="sd">      datearray: the date array from which to infer the interval.</span>

<span class="sd">    Returns:</span>
<span class="sd">      the inferred interval.</span>

<span class="sd">    Raises:</span>
<span class="sd">      RuntimeError: raised if the minimum and most common values are not the</span>
<span class="sd">      same.</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datearray</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">datearray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">datearray</span><span class="p">)</span>
    <span class="n">deltas</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">datearray</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">datearray</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">minimum_val</span> <span class="o">=</span> <span class="n">deltas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">seconds</span> <span class="o">/</span> <span class="mi">60</span>
    <span class="n">common_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">deltas</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">counts</span><span class="o">==</span><span class="n">counts</span><span class="o">.</span><span class="n">max</span><span class="p">())][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">seconds</span> <span class="o">/</span> <span class="mi">60</span>
    <span class="k">if</span> <span class="n">minimum_val</span> <span class="o">==</span> <span class="n">common_val</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">minimum_val</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Minimum and most common values do not coincide!&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_dates" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_dates</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Date parser only.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or 
<code>EddyPro</code>. If None, file_type is fetched. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list(<span title="datetime.datetime">datetime</span>)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of dates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_dates</span><span class="p">(</span>
        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Date parser only.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>
<span class="sd">        file_type: if specified, must be either `TOA5` or </span>
<span class="sd">            `EddyPro`. If None, file_type is fetched. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of dates.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If file type not supplied, detect it.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_type</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="c1"># Get the time variables and rows to skip</span>
    <span class="n">time_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="s1">&#39;time_variables&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">rows_to_skip</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="s1">&#39;header_lines&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="p">))</span>
    <span class="n">rows_to_skip</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="s1">&#39;header_lines&#39;</span><span class="p">][</span><span class="s1">&#39;variable&#39;</span><span class="p">])</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="s1">&#39;separator&#39;</span><span class="p">]</span>

    <span class="c1"># Get the data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="n">file</span><span class="p">,</span>
        <span class="n">usecols</span><span class="o">=</span><span class="n">time_vars</span><span class="p">,</span>
        <span class="n">skiprows</span><span class="o">=</span><span class="n">rows_to_skip</span><span class="p">,</span>
        <span class="n">parse_dates</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DATETIME&#39;</span><span class="p">:</span> <span class="n">time_vars</span><span class="p">},</span>
        <span class="n">sep</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Check the date parser worked - if not, fix it</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">DATETIME</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">DATETIME</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">DATETIME</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Return the dates as pydatetimes</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">DATETIME</span><span class="p">)</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_eligible_concat_files" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_eligible_concat_files</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the list of files that can be concatenated, based on file and file type.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or 
<code>EddyPro</code>. If None, file_type is fetched. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of available backup files.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_eligible_concat_files</span><span class="p">(</span>
        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of files that can be concatenated, based on file and file type.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>
<span class="sd">        file_type: if specified, must be either `TOA5` or </span>
<span class="sd">            `EddyPro`. If None, file_type is fetched. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of available backup files.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">funcs_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;TOA5&#39;</span><span class="p">:</span> <span class="n">get_TOA5_backups</span><span class="p">,</span>
        <span class="s1">&#39;EddyPro&#39;</span><span class="p">:</span> <span class="n">get_EddyPro_files</span>
        <span class="p">}</span>

    <span class="c1"># If file type not supplied, detect it.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_type</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="c1"># Return the files</span>
    <span class="k">return</span> <span class="n">funcs_dict</span><span class="p">[</span><span class="n">file_type</span><span class="p">](</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_file_headers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_headers</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get a list of the header strings.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>begin</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>line number of first header line.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>end</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>line number of last header line.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sep</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>text separation character.</p>
            </div>
          </td>
          <td>
                <code>&#39;,&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of sublists, each sublist containing the text elements of a header 
line.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_headers</span><span class="p">(</span>
        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">begin</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of the header strings.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>
<span class="sd">        begin: line number of first header line.</span>
<span class="sd">        end: line number of last header line.</span>
<span class="sd">        sep: text separation character.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of sublists, each sublist containing the text elements of a header </span>
<span class="sd">            line.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">line_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">begin</span><span class="p">:</span>
                <span class="n">line_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">line_list</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">sep</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_file_info" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_info</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dummy_override</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the information from the first line of the TOA5 file. If EddyPro file
OR dummy_override, just grab the defaults from the configuration dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or 
<code>EddyPro</code>. If None, file_type is fetched.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dummy_override</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to just retrieve the default info. The default 
is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list(str)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of elements.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_info</span><span class="p">(</span>
        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
        <span class="n">dummy_override</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the information from the first line of the TOA5 file. If EddyPro file</span>
<span class="sd">    OR dummy_override, just grab the defaults from the configuration dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>
<span class="sd">        file_type: if specified, must be either `TOA5` or </span>
<span class="sd">            `EddyPro`. If None, file_type is fetched.</span>
<span class="sd">        dummy_override: Whether to just retrieve the default info. The default </span>
<span class="sd">            is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of elements.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If file type not supplied, detect it.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_type</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="c1"># If dummy override (or EddyPro, which has no file info) requested,</span>
    <span class="c1"># return dummy info</span>
    <span class="k">if</span> <span class="n">dummy_override</span> <span class="ow">or</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;EddyPro&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">INFO_FIELDS</span><span class="p">,</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="s1">&#39;dummy_info&#39;</span><span class="p">]))</span>

    <span class="c1"># Otherwise get the TOA5 file info from the file</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
        <span class="n">INFO_FIELDS</span><span class="p">,</span>
        <span class="n">get_file_headers</span><span class="p">(</span>
            <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
            <span class="n">begin</span><span class="o">=</span><span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="s1">&#39;TOA5&#39;</span><span class="p">][</span><span class="s1">&#39;info_line&#39;</span><span class="p">],</span>
            <span class="n">end</span><span class="o">=</span><span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="s1">&#39;TOA5&#39;</span><span class="p">][</span><span class="s1">&#39;info_line&#39;</span><span class="p">],</span>
            <span class="n">sep</span><span class="o">=</span><span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="s1">&#39;TOA5&#39;</span><span class="p">][</span><span class="s1">&#39;separator&#39;</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_file_interval" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_interval</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Find the file interval (i.e. time step)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or 
<code>EddyPro</code>. If None, file_type is fetched. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the inferred file interval.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_interval</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the file interval (i.e. time step)</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>
<span class="sd">        file_type: if specified, must be either `TOA5` or </span>
<span class="sd">            `EddyPro`. If None, file_type is fetched. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the inferred file interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If file type not supplied, detect it.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_type</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">get_datearray_interval</span><span class="p">(</span>
        <span class="n">datearray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">get_dates</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)))</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_file_type" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the file type.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>name of file type (<code>TOA5</code> or <code>EddyPro</code>).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Raised if file type not recognised.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the file type.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        name of file type (`TOA5` or `EddyPro`).</span>

<span class="sd">    Raises:</span>
<span class="sd">      TypeError: Raised if file type not recognised.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">file_type</span> <span class="ow">in</span> <span class="n">FILE_CONFIGS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">id_field</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_file_headers</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
                <span class="n">begin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">sep</span><span class="o">=</span><span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="s1">&#39;separator&#39;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_field</span> <span class="o">==</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="s1">&#39;unique_file_id&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">file_type</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown file type!&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_file_type_configs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_type_configs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_field</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the configuration dictionary for the file type.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or 
  <code>EddyPro</code>. If None, file_type is fetched. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>return_field</code></td>
          <td>
                <code>dict | str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the specific field to return (as str). If None, return all
  (as dict) with fields as keys. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>RuntimeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>raised if file_type is NOT specified and return_field IS
specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>file type configuration field or fields.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_file_type_configs</span><span class="p">(</span>
        <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_field</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the configuration dictionary for the file type.</span>

<span class="sd">    Args:</span>
<span class="sd">      file_type: if specified, must be either `TOA5` or </span>
<span class="sd">          `EddyPro`. If None, file_type is fetched. Default is None.</span>
<span class="sd">      return_field:  the specific field to return (as str). If None, return all</span>
<span class="sd">          (as dict) with fields as keys. Default is None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: raised if file_type is NOT specified and return_field IS</span>
<span class="sd">            specified.</span>

<span class="sd">    Returns:</span>
<span class="sd">        file type configuration field or fields.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_type</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FILE_CONFIGS</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_field</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;Cannot return individual field if file type not set!&#39;</span>
                <span class="p">)</span>
    <span class="k">if</span> <span class="n">return_field</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="n">return_field</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_formatter" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_formatter</span><span class="p">(</span><span class="n">file_type</span><span class="p">,</span> <span class="n">which</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>must be either <code>TOA5</code> or <code>EddyPro</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>which</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>must be one of <code>read_line</code>, <code>write_line</code>, <code>read_date</code> and 
<code>write_date</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>function determined by <code>which</code> arg.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_formatter</span><span class="p">(</span><span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        file_type: must be either `TOA5` or `EddyPro`.</span>
<span class="sd">        which: must be one of `read_line`, `write_line`, `read_date` and </span>
<span class="sd">            `write_date`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        function determined by `which` arg.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">formatter_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;TOA5&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;read_line&#39;</span><span class="p">:</span> <span class="n">_TOA5_line_read_formatter</span><span class="p">,</span>
            <span class="s1">&#39;write_line&#39;</span><span class="p">:</span> <span class="n">_TOA5_line_write_formatter</span><span class="p">,</span>
            <span class="s1">&#39;read_date&#39;</span><span class="p">:</span> <span class="n">_TOA5_date_read_formatter</span><span class="p">,</span>
            <span class="s1">&#39;write_date&#39;</span><span class="p">:</span> <span class="n">_TOA5_date_write_formatter</span>
            <span class="p">},</span>
        <span class="s1">&#39;EddyPro&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;read_line&#39;</span><span class="p">:</span> <span class="n">_EddyPro_line_read_formatter</span><span class="p">,</span>
            <span class="s1">&#39;write_line&#39;</span><span class="p">:</span> <span class="n">_EddyPro_line_write_formatter</span><span class="p">,</span>
            <span class="s1">&#39;read_date&#39;</span><span class="p">:</span> <span class="n">_EddyPro_date_read_formatter</span><span class="p">,</span>
            <span class="s1">&#39;write_date&#39;</span><span class="p">:</span> <span class="n">_EddyPro_date_write_formatter</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="k">return</span> <span class="n">formatter_dict</span><span class="p">[</span><span class="n">file_type</span><span class="p">][</span><span class="n">which</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_header_df" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_header_df</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get a dataframe with variables as index and units and statistical
sampling type (if file type = TOA5) as columns.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or 
<code>EddyPro</code>. If None, file_type is fetched.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.core.frame.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The file header content.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_header_df</span><span class="p">(</span>
        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a dataframe with variables as index and units and statistical</span>
<span class="sd">    sampling type (if file type = TOA5) as columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>
<span class="sd">        file_type: if specified, must be either `TOA5` or </span>
<span class="sd">            `EddyPro`. If None, file_type is fetched.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The file header content.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If file type not supplied, detect it.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_type</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="n">configs_dict</span> <span class="o">=</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">file_type</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
                <span class="n">configs_dict</span><span class="p">[</span><span class="s1">&#39;header_lines&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                <span class="n">get_file_headers</span><span class="p">(</span>
                     <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
                     <span class="n">begin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">configs_dict</span><span class="p">[</span><span class="s1">&#39;header_lines&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                     <span class="n">end</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">configs_dict</span><span class="p">[</span><span class="s1">&#39;header_lines&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                     <span class="n">sep</span><span class="o">=</span><span class="n">configs_dict</span><span class="p">[</span><span class="s1">&#39;separator&#39;</span><span class="p">]</span>
                     <span class="p">)</span>
                <span class="p">))</span>
            <span class="p">)</span>
        <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.get_start_end_dates" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_start_end_dates</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get start and end dates only.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path of file to parse.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or 
<code>EddyPro</code>. If None, file_type is fetched. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dictionary containing start and end dates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_start_end_dates</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get start and end dates only.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: absolute path of file to parse.</span>
<span class="sd">        file_type: if specified, must be either `TOA5` or </span>
<span class="sd">            `EddyPro`. If None, file_type is fetched. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dictionary containing start and end dates.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If file type not supplied, detect it.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_type</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">get_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="c1"># Get the formatters</span>
    <span class="n">line_formatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;read_line&#39;</span><span class="p">)</span>
    <span class="n">date_formatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;read_date&#39;</span><span class="p">)</span>

    <span class="c1"># Open file in binary</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

        <span class="c1"># Iterate forward to find first valid start date</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">start_date</span> <span class="o">=</span> <span class="n">date_formatter</span><span class="p">(</span><span class="n">line_formatter</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">()))</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="c1"># Iterate backwards to find last valid end date</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_END</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">end_date</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">date_formatter</span><span class="p">(</span>
                                <span class="n">line_formatter</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
                                <span class="p">)</span>
                            <span class="p">)</span>
                        <span class="k">break</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">(),</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;start_date&#39;</span><span class="p">:</span> <span class="n">start_date</span><span class="p">,</span> <span class="s1">&#39;end_date&#39;</span><span class="p">:</span> <span class="n">end_date</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.reformat_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reformat_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">output_format</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Take a dataset of generic intermediary data format and turn it into 
either TOA5 or EddyPro data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the data to be reformatted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_format</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the output format (must be <code>TOA5</code> or <code>EddyPro</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the reformatted data.  </p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Raised if the data does not have a datetime index.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reformat_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take a dataset of generic intermediary data format and turn it into </span>
<span class="sd">    either TOA5 or EddyPro data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: the data to be reformatted.</span>
<span class="sd">        output_format: the output format (must be `TOA5` or `EddyPro`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        the reformatted data.  </span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: Raised if the data does not have a datetime index.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialisation stuff</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">indexes</span><span class="o">.</span><span class="n">datetimes</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Passed data must have a DatetimeIndex!&#39;</span><span class="p">)</span>
    <span class="n">_check_format</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">output_format</span><span class="p">)</span>
    <span class="n">funcs_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TOA5&#39;</span><span class="p">:</span> <span class="n">_TOA5ify_data</span><span class="p">,</span> <span class="s1">&#39;EddyPro&#39;</span><span class="p">:</span> <span class="n">_EPify_data</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Remove all format-specific data columns to make data format-agnostic.</span>
    <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">FILE_CONFIGS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">fmt</span><span class="p">][</span><span class="s1">&#39;time_variables&#39;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
    <span class="k">return</span> <span class="n">funcs_dict</span><span class="p">[</span><span class="n">output_format</span><span class="p">](</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.reformat_headers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reformat_headers</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">output_format</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Create formatted header from dataframe header.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>headers</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the headers to be reformatted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_format</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the output format (must be <code>TOA5</code> or <code>EddyPro</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>thereformatted headers.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reformat_headers</span><span class="p">(</span><span class="n">headers</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create formatted header from dataframe header.</span>

<span class="sd">    Args:</span>
<span class="sd">        headers: the headers to be reformatted.</span>
<span class="sd">        output_format: the output format (must be `TOA5` or `EddyPro`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        thereformatted headers.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialisation stuff</span>
    <span class="n">_check_format</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">output_format</span><span class="p">)</span>
    <span class="n">funcs_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TOA5&#39;</span><span class="p">:</span> <span class="n">_TOA5ify_headers</span><span class="p">,</span> <span class="s1">&#39;EddyPro&#39;</span><span class="p">:</span> <span class="n">_EPify_headers</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Remove all format-specific header columns to make header format-agnostic.</span>
    <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">FILE_CONFIGS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">fmt</span><span class="p">][</span><span class="s1">&#39;non_numeric_cols&#39;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>

    <span class="c1"># Pass to function to format header as appropriate</span>
    <span class="k">return</span> <span class="n">funcs_dict</span><span class="p">[</span><span class="n">output_format</span><span class="p">](</span><span class="n">headers</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="calculator.file_io.write_data_to_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">write_data_to_file</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">abs_file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Write headers and data to file. Checks only for consistency between 
headers and data column names (no deeper analysis of consistency with 
                               output format).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>headers</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dataframe containing the headers as columns.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dataframe containing the data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>abs_file_path</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>absolute path (including file name) to write to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_format</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if specified, must be either <code>TOA5</code> or <code>EddyPro</code>. The 
  default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>info</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the file info to write as first header line. Only required if 
  outputting TOA5, and retrieves file type-specific dummy input if not 
  specified. The default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>calculator/file_io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_data_to_file</span><span class="p">(</span>
        <span class="n">headers</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
        <span class="n">abs_file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">output_format</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
        <span class="n">info</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write headers and data to file. Checks only for consistency between </span>
<span class="sd">    headers and data column names (no deeper analysis of consistency with </span>
<span class="sd">                                   output format).</span>

<span class="sd">    Args:</span>
<span class="sd">      headers: the dataframe containing the headers as columns.</span>
<span class="sd">      data: the dataframe containing the data.</span>
<span class="sd">      abs_file_path: absolute path (including file name) to write to.</span>
<span class="sd">      output_format: if specified, must be either `TOA5` or `EddyPro`. The </span>
<span class="sd">          default is None.</span>
<span class="sd">      info: the file info to write as first header line. Only required if </span>
<span class="sd">          outputting TOA5, and retrieves file type-specific dummy input if not </span>
<span class="sd">          specified. The default is None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Cross-check header / data column consistency</span>
    <span class="n">_check_data_header_consistency</span><span class="p">(</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span>
        <span class="p">)</span>

    <span class="c1"># Add the requisite info to the output if TOA5</span>
    <span class="n">row_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">output_format</span><span class="p">:</span>
        <span class="n">output_format</span> <span class="o">=</span> <span class="s1">&#39;TOA5&#39;</span>
    <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">&#39;TOA5&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
                <span class="n">INFO_FIELDS</span><span class="p">,</span>
                <span class="n">FILE_CONFIGS</span><span class="p">[</span><span class="n">output_format</span><span class="p">][</span><span class="s1">&#39;dummy_info&#39;</span><span class="p">]</span>
                <span class="p">))</span>
        <span class="n">row_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="c1"># Construct the row list</span>
    <span class="n">output_headers</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="p">[</span><span class="n">row_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_headers</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">output_headers</span><span class="p">]</span>

    <span class="c1"># Write the data to file</span>
    <span class="n">file_configs</span> <span class="o">=</span> <span class="n">get_file_type_configs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">output_format</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">abs_file_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

        <span class="c1"># Write the header</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span>
            <span class="n">f</span><span class="p">,</span>
            <span class="n">delimiter</span><span class="o">=</span><span class="n">file_configs</span><span class="p">[</span><span class="s1">&#39;separator&#39;</span><span class="p">],</span>
            <span class="n">quoting</span><span class="o">=</span><span class="n">file_configs</span><span class="p">[</span><span class="s1">&#39;quoting&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">row_list</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="c1"># Write the data</span>
        <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
            <span class="n">f</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na_rep</span><span class="o">=</span><span class="n">file_configs</span><span class="p">[</span><span class="s1">&#39;na_values&#39;</span><span class="p">],</span>
            <span class="n">sep</span><span class="o">=</span><span class="n">file_configs</span><span class="p">[</span><span class="s1">&#39;separator&#39;</span><span class="p">],</span> <span class="n">quoting</span><span class="o">=</span><span class="n">file_configs</span><span class="p">[</span><span class="s1">&#39;quoting&#39;</span><span class="p">]</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>